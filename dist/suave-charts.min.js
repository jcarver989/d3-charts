var AbstractChart,bind=function(b,a){return function(){return b.apply(a,arguments)}};
AbstractChart=function(){function b(a,d){var c,b;null==d&&(d={});this.updateDimensions=bind(this.updateDimensions,this);this.options=this.mergeOptions(defaultOptions,d);this.svg=new Svg(a,this.options.margin);this.scales=Scales.fromString(this.options.xScale,this.options.yScale);this.axes=new Axes(this.svg.chart,this.scales,this.options);c=this.options.aspectRatio.split(":");b=c[0];c=c[1];this.aspectRatio=[parseInt(b),parseInt(c)];this.updateDimensions()}b.prototype.mergeOptions=function(a,d){var c,
b;b={};for(c in a)b[c]=a[c];for(c in d)b[c]=d[c];return b};b.prototype.updateDimensions=function(){var a,d,c;c=this.svg.getSize()[0];d=c/this.aspectRatio[0]*this.aspectRatio[1];a=this.options.margin;this.width=c-a.left-a.right;this.height=d-a.bottom-a.top;this.scales.setRanges(this.width,this.height);return this.svg.setSize(c,d)};return b}();var Axes;
Axes=function(){function b(a,d,c){this.options=c;this.xAxisSelection=a.append("g").attr("class","x axis");this.yAxisSelection=a.append("g").attr("class","y axis");this.xAxis=this.newAxis(d.x,"bottom");this.yAxis=this.newAxis(d.y,"left")}b.prototype.draw=function(a,d){var c;this.xAxisSelection.attr("transform","translate(0,"+d+")");this.options.grid&&(this.xAxis.tickSize(-d),this.yAxis.tickSize(-a));this.options.xTickInterval?(c=function(){switch(this.options.xTickInterval){case "seconds":return d3.time.seconds;case "minutes":return d3.time.minutes;
case "hours":return d3.time.hours;case "days":return d3.time.days;case "months":return d3.time.months;case "years":return d3.time.years}}.call(this),this.xAxis.ticks(c)):null!=this.options.ticks&&0<this.options.ticks&&this.xAxis.ticks(this.options.ticks);this.options.xTickFormat&&this.xAxis.tickFormat(d3.time.format(this.options.xTickFormat));this.xAxisSelection.call(this.xAxis);return this.yAxisSelection.call(this.yAxis)};b.prototype.newAxis=function(a,d){return d3.svg.axis().scale(a).orient(d).tickPadding(this.options.tickPadding)};
return b}();var defaultOptions;defaultOptions={xScale:"linear",yScale:"linear",smoothLines:!1,tooltips:!0,aspectRatio:"16:9",tickPadding:10,dotSize:6,grid:!0,margin:{top:50,bottom:50,right:80,left:80}};var LineChart,bind=function(b,a){return function(){return b.apply(a,arguments)}},extend=function(b,a){function d(){this.constructor=b}for(var c in a)hasProp.call(a,c)&&(b[c]=a[c]);d.prototype=a.prototype;b.prototype=new d;b.__super__=a.prototype;return b},hasProp={}.hasOwnProperty;
LineChart=function(b){function a(d,c){null==c&&(c={});this.render=bind(this.render,this);a.__super__.constructor.call(this,d,c);this.line=d3.svg.line().x(this.scales.scaleX).y(this.scales.scaleY);this.area=d3.svg.area().x(this.scales.scaleX).y(this.scales.scaleY);d3.select(window).on("resize",this.render)}extend(a,b);a.prototype.enterLines=function(a){return a.append("path").attr("class",function(a){return"line "+a.label})};a.prototype.enterAreas=function(a){return a.filter(function(a){return!0===
a.area}).append("path").attr("class",function(a){return"area "+a.label})};a.prototype.createTooltip=function(){var a;a=this.tip||(this.tip=new Tooltip(document));this.dots.on("mouseover",function(c){a.html(c[1]);return a.show(this)});return this.dots.on("mouseout",function(c){return a.hide()})};a.prototype.render=function(a){null==a&&(a=!0);a&&this.updateDimensions();this.axes.draw(this.width,this.height);this.lines.attr("d",function(a){return function(d){a.line.interpolate(a.chooseInterpolation(d));
return a.line(d.data)}}(this));this.area.y0(this.height);this.areas.attr("d",function(a){return function(d){a.area.interpolate(a.chooseInterpolation(d));return a.area(d.data)}}(this));return this.dots.attr("cx",this.scales.scaleX).attr("cy",this.scales.scaleY)};a.prototype.chooseInterpolation=function(a){return a.smooth?"monotone":"linear"};a.prototype.draw=function(a){var b,e;b=d3.merge(function(){var b,c,f;f=[];b=0;for(c=a.length;b<c;b++)e=a[b],f.push(e.data);return f}());this.scales.setDomains(b);
this.lineGroups=this.svg.chart.selectAll(".lineGroup").data(a,function(a){return a.label});b=this.lineGroups.enter().append("g").attr("class","lineGroup");this.enterLines(b);this.enterAreas(b);this.lines=this.lineGroups.selectAll(".line");this.areas=this.lineGroups.selectAll(".area");this.dotGroups=this.svg.chart.selectAll(".dotGroup").data(a,function(a){return a.label});this.dotGroups.enter().append("g").attr("class","dotGroup");this.dots=this.dotGroups.selectAll(".dot").data(function(a){var b,d,
c,e,g;if(!1===a.dots)return[];e=a.data;g=[];d=0;for(c=e.length;d<c;d++)b=e[d],g.push([b[0],b[1],a.label]);return g});this.dots.enter().append("circle").attr("class",function(a){return"dot "+a[2]}).attr("r",this.options.dotSize);this.options.tooltips&&this.createTooltip();return this.render(!1)};return a}(AbstractChart);var Scales,bind=function(b,a){return function(){return b.apply(a,arguments)}};
Scales=function(){function b(a,b){this.x=a;this.y=b;this.setRanges=bind(this.setRanges,this);this.setDomains=bind(this.setDomains,this);this.scaleY=bind(this.scaleY,this);this.scaleX=bind(this.scaleX,this)}b.fromString=function(a,d){return new b(b.selectScale(a),b.selectScale(d))};b.selectScale=function(a){switch(a){case "linear":return d3.scale.linear();case "log":return d3.scale.log();case "time":return d3.time.scale();case "ordinal":return d3.scale.ordinal()}};b.prototype.scaleX=function(a){return this.x(a[0])};
b.prototype.scaleY=function(a){return this.y(a[1])};b.prototype.setDomains=function(a){this.x.domain(d3.extent(a,function(a){return a[0]})).nice();return this.y.domain([0,d3.max(a,function(a){return a[1]})]).nice()};b.prototype.setRanges=function(a,b){this.x.range([0,a]);return this.y.range([b,0])};return b}();var ScatterPlot,extend=function(b,a){function d(){this.constructor=b}for(var c in a)hasProp.call(a,c)&&(b[c]=a[c]);d.prototype=a.prototype;b.prototype=new d;b.__super__=a.prototype;return b},hasProp={}.hasOwnProperty;
ScatterPlot=function(b){function a(b,c){null==c&&(c={});a.__super__.constructor.call(this,b,c)}extend(a,b);a.prototype.draw=function(a){this.x.domain(d3.extent(a,extractX));this.y.domain([0,d3.max(a,extractY)]);this.drawAxes();a=this.svg.selectAll("circle").data(a);a.enter().append("circle").attr("class",function(a){return"circle "+(a.css_class||"")}).attr("r",5).attr("cx",function(a){return function(b){return a.x(extractX(b))}}(this)).attr("cy",function(a){return function(b){return a.y(extractY(b))}}(this));
return a.exit().remove()};return a}(AbstractChart);var Svg;Svg=function(){function b(a,b){this.domElement=document.querySelector(a);this.container=d3.select(this.domElement).append("svg").attr("preserveAspectRatio","xMinYMin");this.chart=this.container.append("g").attr("transform","translate("+b.left+","+b.top+")")}b.prototype.getSize=function(){return[this.domElement.offsetWidth,this.domElement.offsetHeight]};b.prototype.setSize=function(a,b){return this.container.attr("width",a).attr("height",b)};return b}();var Tooltip,bind=function(b,a){return function(){return b.apply(a,arguments)}};
Tooltip=function(){function b(a){this.hide=bind(this.hide,this);this.show=bind(this.show,this);this.html=bind(this.html,this);this.cssClass="suave-tooltip";this.tip=d3.select(a.createElement("div"));this.tip.attr("class",this.cssClass);a.body.appendChild(this.tip.node())}b.prototype.html=function(a){return this.tip.html(a)};b.prototype.show=function(a){a=this.offset(a);this.tip.attr("class",this.cssClass+" show");return this.tip.style({position:"absolute",top:a.top+"px",left:a.left+"px"})};b.prototype.hide=
function(){return this.tip.attr("class",this.cssClass)};b.prototype.offset=function(a){var b,c;b=a.getBoundingClientRect();a=b.left+(b.right-b.left)/2;c=this.tip.node().getBoundingClientRect();return{top:b.top-(c.bottom-c.top+10)+window.scrollY,left:a-(c.right-c.left)/2+window.scrollX}};return b}();
